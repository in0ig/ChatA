import{d as He,u as T,s as b,_ as ie,c as g,o as h,a as s,t as S,F as P,r as B,n as Ne,b as $e,e as je,f as x,g as A,w as se,h as H,i as u,j as w,k as I,l as d,m as $,q as Je,p as Me,v,x as Qe,y as Ge,z as We,A as Ie,B as Xe,C as Ye,D as re,E as Ue,G as Ze,H as et,I as tt,T as at,J as Re,K as st,L as j,M as ot,N as nt,O as lt,P as rt,Q as it}from"./index-UzuFSHw5.js";import{dataTableApi as xe}from"./dataTableApi-BlCX55nQ.js";const ct=He("chat",{state:()=>({currentSessionId:"test-session-id",sessions:[],messages:[],inputText:"",currentDataSource:null,chatMode:"query",recommendedQuestions:["2023å¹´å„å•†å“ç±»åˆ«çš„é”€å”®é¢æ˜¯å¤šå°‘ï¼Ÿ","2024å¹´æ¯›åˆ©æœ€é«˜çš„äº§å“æ˜¯ä»€ä¹ˆï¼Ÿ","æœ€è¿‘7å¤©çš„é”€å”®è¶‹åŠ¿å¦‚ä½•ï¼Ÿ","å„åŒºåŸŸçš„é”€å”®å¯¹æ¯”æƒ…å†µ","å®¢æˆ·è½¬åŒ–ç‡çš„å˜åŒ–è¶‹åŠ¿"],queryHistory:[],queryCache:new Map,conversationHistory:[],sessionContext:{local_model:{messages:[],tokenCount:0,summary:null,lastSummaryAt:null},aliyun_model:{messages:[],tokenCount:0,summary:null,lastSummaryAt:null}},tokenUsage:{sessionId:"test-session-id",totalTurns:0,totalInputTokens:0,totalOutputTokens:0,totalTokens:0,modelUsage:{}}}),getters:{canSend:e=>e.inputText.trim().length>0&&e.currentDataSource!==null,currentSession:e=>e.sessions.find(a=>a.id===e.currentSessionId)||null,hasActiveSession:e=>e.currentSessionId!==null},actions:{addMessage(e){this.conversationHistory.push(e);const a=e.modelUsed.includes("local")?"local_model":"aliyun_model";this.sessionContext[a].tokenCount+=e.tokenCount,this.sessionContext[a].messages.push(e),this.tokenUsage.totalTurns+=1,this.tokenUsage.totalTokens+=e.tokenCount,e.role==="user"?this.tokenUsage.totalInputTokens+=e.tokenCount:this.tokenUsage.totalOutputTokens+=e.tokenCount,this.tokenUsage.modelUsage[e.modelUsed]||(this.tokenUsage.modelUsage[e.modelUsed]={input:0,output:0}),e.role==="user"?this.tokenUsage.modelUsage[e.modelUsed].input+=e.tokenCount:this.tokenUsage.modelUsage[e.modelUsed].output+=e.tokenCount},getConversationHistory(){return this.conversationHistory.map(e=>e.id?e:{...e,id:`conv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`})},checkTokenLimit(e){const a=e==="local"?15e3:8e5,t=e+"_model";return this.sessionContext[t].tokenCount>=a},async summarizeContext(e){const a=e+"_model",t=this.sessionContext[a];if(t.messages.length===0||t.summary)return;const l=`ä¼šè¯æ€»ç»“ï¼šåŒ…å«${t.messages.length}æ¡æ¶ˆæ¯ï¼Œæ€»Tokenæ•°ï¼š${t.tokenCount}`;t.summary=l,t.lastSummaryAt=new Date,this.tokenUsage.sessionId=this.currentSessionId||""},getTokenUsageStats(){return{...this.tokenUsage,modelUsage:JSON.parse(JSON.stringify(this.tokenUsage.modelUsage))}},async loadSessions(){const e=T();try{const a=await b.get("/sessions/"),t=a.data||a;this.sessions=t.map(l=>({...l,lastActive:new Date(l.last_active),createdAt:new Date(l.created_at)}))}catch(a){e.showToast(a.message,"error")}},async createSession(){const e=T();try{const a=await b.post("/sessions",{user_id:1,session_id:null,conversation:[]}),t=a.data||a;this.sessions.unshift({...t,lastActive:new Date(t.last_active),createdAt:new Date(t.created_at)}),this.currentSessionId=t.session_id,this.messages=[],e.showToast("æ–°ä¼šè¯å·²åˆ›å»º","success")}catch(a){e.showToast(a.message,"error")}},async switchSession(e){this.currentSessionId=e;const a=this.currentSession;a&&(this.messages=a.conversation)},async deleteSession(e){const a=T();try{await b.delete(`/sessions/${e}`),this.sessions=this.sessions.filter(t=>t.id!==e),this.currentSessionId===e&&(this.currentSessionId=this.sessions[0]?.id||null),a.showToast("ä¼šè¯å·²åˆ é™¤","success")}catch(t){a.showToast(t.message,"error")}},async sendMessage(e){const a=T(),t=e||this.inputText;if(!t.trim())return;if(!this.currentDataSource){a.showToast("è¯·å…ˆé€‰æ‹©æ•°æ®æº","warning");return}const l=`${t.trim()}|${this.currentDataSource}`,r=this.queryCache.get(l);if(r){const p={id:`msg_${Date.now()}_ai`,role:"assistant",content:r.result.explanation||"æŸ¥è¯¢å®Œæˆ",timestamp:new Date,chartType:r.result.chart_type,chartData:r.result.data,actions:[{type:"refresh",label:"åˆ·æ–°",handler:()=>this.sendMessage(t)},{type:"like",label:"ç‚¹èµ",handler:()=>console.log("liked")},{type:"dislike",label:"ç‚¹è¸©",handler:()=>console.log("disliked")}]},m={id:`msg_${Date.now()}`,role:"user",content:t,timestamp:new Date};this.messages.push(m),this.inputText="",this.messages.push(p),this.addToHistory(t,r.result,r.result.chart_type);return}const c={id:`msg_${Date.now()}`,role:"user",content:t,timestamp:new Date};this.messages.push(c),this.inputText="",a.setLoading(!0,"æ­£åœ¨åˆ†ææ‚¨çš„é—®é¢˜...");try{const p=await b.post("/query",{text:t,session_id:this.currentSessionId,data_source_id:this.currentDataSource,mode:this.chatMode}),m=p.data||p,R={id:`msg_${Date.now()}_ai`,role:"assistant",content:m.result?.explanation||"æŸ¥è¯¢å®Œæˆ",timestamp:new Date,chartType:m.result?.chart_type,chartData:m.result?.data,actions:[{type:"refresh",label:"åˆ·æ–°",handler:()=>this.sendMessage(t)},{type:"like",label:"ç‚¹èµ",handler:()=>console.log("liked")},{type:"dislike",label:"ç‚¹è¸©",handler:()=>console.log("disliked")}]};this.messages.push(R),this.addToHistory(t,m.result,m.result?.chart_type),this.queryCache.set(l,{result:m.result,timestamp:new Date})}catch(p){a.showToast(p.message,"error");const m={id:`msg_${Date.now()}_error`,role:"assistant",content:`æŠ±æ­‰ï¼Œå¤„ç†æ‚¨çš„è¯·æ±‚æ—¶å‡ºç°é”™è¯¯ï¼š${p.message}`,timestamp:new Date};this.messages.push(m)}finally{a.setLoading(!1)}},clearMessages(){this.messages=[]},toggleChatMode(){this.chatMode=this.chatMode==="query"?"report":"query"},setChatMode(e){this.chatMode=e},setDataSource(e){this.currentDataSource=e},async loadHistory(){const e=T();try{const a=await b.get("/query/history"),t=a.data||a;this.queryHistory=t.map(l=>({...l,createdAt:new Date(l.created_at)}))}catch(a){e.showToast(a.message,"error")}},addToHistory(e,a,t){this.queryHistory.unshift({id:Date.now(),queryText:e,result:a,chartType:t,createdAt:new Date}),this.queryHistory.length>50&&(this.queryHistory=this.queryHistory.slice(0,50))},async clearHistory(){const e=T();try{await b.delete("/query/history"),this.queryHistory=[],e.showToast("å†å²è®°å½•å·²æ¸…ç©º","success")}catch(a){e.showToast(a.message,"error")}},selectRecommendedQuestion(e){this.inputText=e,this.sendMessage()},clearCache(){this.queryCache.clear()}}}),dt=()=>{const e="chartRendererLogs";let a=[];try{const t=localStorage.getItem(e);t&&(a=JSON.parse(t))}catch{console.warn("Failed to load chart logs from localStorage")}return{logs:a,logKey:e}},le=(e,a,t=null)=>{const r={timestamp:new Date().toISOString(),type:e,message:a,data:t};switch(e){case"update":console.groupCollapsed("%cChart Data Updated","color: #1890ff; font-weight: bold"),console.log("Title:",a),console.log("Data count:",t?.data?.length),console.log("Max value:",t?.maxValue),console.log("Data:",t?.data),console.groupEnd();break;case"format":console.groupCollapsed("%cCurrency Formatted","color: #52c41a; font-weight: bold"),console.log("Original value:",a),console.log("Formatted result:",t),console.groupEnd();break;case"render":console.groupCollapsed("%cChart Rendered","color: #666; font-weight: bold"),console.log("Component rendered with title:",a),console.log("Data structure:",t?.data),console.groupEnd();break;default:console.log(`[${e}]`,a,t)}const{logs:c,logKey:p}=dt();c.push(r),c.length>500&&c.shift();try{localStorage.setItem(p,JSON.stringify(c))}catch{console.warn("Failed to save chart logs to localStorage")}},ut={name:"ChartRenderer",props:{chartTitle:String,data:Array,maxValue:Number},methods:{formatCurrency(e){return le("format",e,typeof e=="number"?"Â¥"+e.toLocaleString():e),typeof e!="number"?e:"Â¥"+e.toLocaleString()}},watch:{data:{handler(e,a){le("update",this.chartTitle,{data:e,maxValue:this.maxValue,oldData:a})},deep:!0},chartTitle:{handler(e){le("update",e,{data:this.data,maxValue:this.maxValue})}},maxValue:{handler(e){le("update",this.chartTitle,{data:this.data,maxValue:e})}}},mounted(){le("render",this.chartTitle,{data:this.data,maxValue:this.maxValue})}},ht={class:"chart-container"},pt={class:"chart-placeholder"},mt={class:"chart-title"},gt={class:"chart-label"},ft={class:"chart-value"};function yt(e,a,t,l,r,c){return h(),g("div",ht,[s("div",pt,[s("div",mt,S(t.chartTitle),1),(h(!0),g(P,null,B(t.data,(p,m)=>(h(),g("div",{key:m,class:"chart-bar",style:Ne({height:p.value/t.maxValue*100+"%"})},[s("span",gt,S(p.label),1),s("span",ft,S(c.formatCurrency(p.value)),1)],4))),128))])])}const _t=ie(ut,[["render",yt],["__scopeId","data-v-3c89b86b"]]),vt=()=>{const e="dataTableLogs";let a=[];try{const t=localStorage.getItem(e);t&&(a=JSON.parse(t))}catch{console.warn("Failed to load table logs from localStorage")}return{logs:a,logKey:e}},te=(e,a,t=null)=>{const r={timestamp:new Date().toISOString(),type:e,message:a,data:t};switch(e){case"update":console.groupCollapsed("%cTable Data Updated","color: #1890ff; font-weight: bold"),console.log("Headers count:",a),console.log("Rows count:",t?.rows?.length),console.log("Headers:",t?.headers),console.log("Rows:",t?.rows),console.groupEnd();break;case"format":console.groupCollapsed("%cCell Formatted","color: #52c41a; font-weight: bold"),console.log("Original value:",a),console.log("Column index:",t?.index),console.log("Formatted result:",t?.result),console.log("Is currency column:",t?.isCurrency),console.groupEnd();break;case"render":console.groupCollapsed("%cTable Rendered","color: #666; font-weight: bold"),console.log("Component rendered with headers:",a),console.log("Rows structure:",t?.rows),console.groupEnd();break;default:console.log(`[${e}]`,a,t)}const{logs:c,logKey:p}=vt();c.push(r),c.length>500&&c.shift();try{localStorage.setItem(p,JSON.stringify(c))}catch{console.warn("Failed to save table logs to localStorage")}},wt={name:"DataTable",props:{headers:Array,rows:Array},methods:{isCurrencyColumn(e){return te("format","isCurrencyColumn check",{index:e,result:e===1}),e===1},formatCell(e,a){const t=this.isCurrencyColumn(a);let l=e;if(t&&typeof e=="number")try{l=this.$root.formatCurrency?this.$root.formatCurrency(e):"Â¥"+e.toLocaleString()}catch(r){l="Â¥"+e.toLocaleString(),te("error","Format currency failed",{value:e,index:a,error:r.message})}return te("format",e,{index:a,isCurrency:t,result:l}),l}},watch:{headers:{handler(e,a){te("update",e?.length||0,{headers:e,rows:this.rows,oldHeaders:a})},deep:!0},rows:{handler(e,a){te("update",this.headers?.length||0,{headers:this.headers,rows:e,oldRows:a})},deep:!0}},mounted(){te("render",this.headers?.length||0,{headers:this.headers,rows:this.rows})}},St={class:"data-table"};function bt(e,a,t,l,r,c){return h(),g("div",St,[a[0]||(a[0]=s("h4",null,"è¯¦ç»†æ•°æ®",-1)),s("table",null,[s("thead",null,[s("tr",null,[(h(!0),g(P,null,B(t.headers,p=>(h(),g("th",{key:p},S(p),1))),128))])]),s("tbody",null,[(h(!0),g(P,null,B(t.rows,(p,m)=>(h(),g("tr",{key:m},[(h(!0),g(P,null,B(p,(R,L)=>(h(),g("td",{key:L,class:$e({currency:c.isCurrencyColumn(L)})},S(c.formatCell(R,L)),3))),128))]))),128))])])])}const Ct=ie(wt,[["render",bt],["__scopeId","data-v-6425bbe7"]]),kt={class:"search-filter-section"},Tt={class:"search-tip-icon"},Dt={class:"quick-filters"},xt={key:0,class:"batch-actions"},$t={class:"batch-action-buttons"},Mt={key:1,class:"loading-container"},Lt={class:"loading-animation"},Vt={class:"loading-progress"},At={class:"loading-text"},It={class:"loading-icon"},Ut={key:2,class:"error-container"},Rt={class:"error-actions"},Et={key:3,class:"table-list"},Ht={key:0,class:"empty-state"},zt={class:"empty-actions"},qt={key:1,class:"table-list-content"},Pt={class:"list-header"},Bt={class:"list-stats"},Kt={key:0},Ot={class:"sort-options"},Ft={class:"table-items"},Nt=["onClick","onMouseenter"],jt={class:"table-info"},Jt={class:"table-header"},Qt={class:"table-name"},Gt={class:"table-badges"},Wt={key:0,class:"pin-icon",color:"#f56c6c"},Xt={class:"table-description"},Yt={class:"table-id"},Zt={class:"table-status"},ea=["color"],ta={class:"table-actions"},aa=["color"],sa={class:"footer-actions"},oa={class:"selection-summary"},na={key:1,class:"no-selection"},la={class:"action-buttons"},ra={key:0},ia=je({__name:"DataSourceSelector",props:{modelValue:{type:Boolean},dataSources:{},isLoading:{type:Boolean},error:{}},emits:["update:modelValue","confirm","preview","retry","info"],setup(e,{emit:a}){const t=e,l=a,r=x(t.modelValue),c=x(""),p=x("all"),m=x([]),R=x("name"),L=x(null),K=x(!1),M=x(0),C=A(()=>t.dataSources.length),V=A(()=>t.dataSources.filter(o=>o.pinned).length),X=A(()=>[...new Set(t.dataSources.map(n=>n.type))].map(n=>({value:n,label:q(n)}))),E=A(()=>{let o=t.dataSources;if(p.value==="selected"?o=o.filter(n=>n.selected):p.value==="pinned"&&(o=o.filter(n=>n.pinned)),m.value.length>0&&(o=o.filter(n=>m.value.includes(n.type))),c.value){const n=c.value.toLowerCase();o=o.filter(U=>U.name.toLowerCase().includes(n)||U.id.toLowerCase().includes(n)||U.description&&U.description.toLowerCase().includes(n))}return o}),F=A(()=>[...E.value].sort((o,n)=>{if(o.pinned&&!n.pinned)return-1;if(!o.pinned&&n.pinned)return 1;switch(R.value){case"selected":if(o.selected&&!n.selected)return-1;if(!o.selected&&n.selected)return 1;break;case"type":const U=o.type.localeCompare(n.type);if(U!==0)return U;break;case"pinned":break;default:return o.name.localeCompare(n.name)}return o.name.localeCompare(n.name)})),z=A(()=>t.dataSources.filter(o=>o.selected).length);se(()=>t.modelValue,o=>{r.value=o,o&&(oe(),J())}),se(()=>t.isLoading,o=>{o?J():M.value=100});const J=()=>{M.value=0;const o=setInterval(()=>{M.value+=Math.random()*20,(M.value>=90||!t.isLoading)&&(clearInterval(o),t.isLoading||(M.value=100))},200)},oe=()=>{c.value="",p.value="all",m.value=[],R.value="name"},O=()=>{r.value=!1,l("update:modelValue",!1)},Q=o=>{p.value=o},k=()=>{st(()=>{const o=document.querySelector(".table-list-content");o&&(o.scrollTop=0)})},G=()=>{c.value=""},ve=o=>o,we=o=>{R.value=o},Se=o=>{ce(o,!o.selected)},be=o=>{L.value=o.id},Ce=()=>{L.value=null},ce=(o,n)=>{o.selected=n,n&&j.success(`å·²é€‰æ‹© ${o.name}`)},de=()=>{E.value.forEach(o=>{o.selected=!0}),j.success(`å·²é€‰æ‹© ${E.value.length} ä¸ªæ•°æ®æº`)},ke=()=>{t.dataSources.forEach(o=>{o.selected=!1}),j.info("å·²æ¸…ç©ºé€‰æ‹©")},ue=()=>{E.value.forEach(o=>{o.selected=!o.selected}),j.info("å·²åé€‰å½“å‰ç­›é€‰ç»“æœ")},he=()=>{const o=t.dataSources.filter(n=>n.selected);o.forEach(n=>{n.pinned=!0}),j.success(`å·²ç½®é¡¶ ${o.length} ä¸ªæ•°æ®æº`)},pe=o=>{o.pinned=!o.pinned,j.success(o.pinned?`${o.name} å·²ç½®é¡¶`:`${o.name} å·²å–æ¶ˆç½®é¡¶`)},me=(o,n)=>{switch(n){case"info":l("info",o);break;case"copy":navigator.clipboard.writeText(o.id).then(()=>{j.success("ID å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")});break;case"export":const U={id:o.id,name:o.name,type:o.type,selected:o.selected,pinned:o.pinned},De=new Blob([JSON.stringify(U,null,2)],{type:"application/json"}),D=URL.createObjectURL(De),ne=document.createElement("a");ne.href=D,ne.download=`${o.name}-config.json`,ne.click(),URL.revokeObjectURL(D),j.success("é…ç½®å·²å¯¼å‡º");break}},_=()=>c.value?"æœªæ‰¾åˆ°åŒ¹é…çš„æ•°æ®æº":p.value==="selected"?"æš‚æ— å·²é€‰æ‹©çš„æ•°æ®æº":p.value==="pinned"?"æš‚æ— ç½®é¡¶çš„æ•°æ®æº":"æš‚æ— å¯ç”¨çš„æ•°æ®æº",i=()=>c.value?`æœç´¢ "${c.value}" æ²¡æœ‰æ‰¾åˆ°ç›¸å…³ç»“æœï¼Œè¯·å°è¯•å…¶ä»–å…³é”®è¯`:p.value==="selected"?"è¯·å…ˆé€‰æ‹©ä¸€äº›æ•°æ®æºï¼Œç„¶åå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹":p.value==="pinned"?"æ‚¨å¯ä»¥é€šè¿‡ç‚¹å‡»æ˜Ÿæ ‡å›¾æ ‡æ¥ç½®é¡¶å¸¸ç”¨çš„æ•°æ®æº":"ç³»ç»Ÿä¸­è¿˜æ²¡æœ‰é…ç½®ä»»ä½•æ•°æ®æºï¼Œè¯·å…ˆæ·»åŠ æ•°æ®æº",q=o=>({mysql:"MySQL",excel:"Excel",api:"API",csv:"CSV",postgresql:"PostgreSQL",sqlite:"SQLite"})[o]||o.toUpperCase(),N=o=>({mysql:"primary",excel:"success",api:"warning",csv:"info",postgresql:"primary",sqlite:"info"})[o]||"default",ee=o=>{l("preview",o)},Te=()=>{l("retry")},ge=async()=>{K.value=!0;try{await new Promise(n=>setTimeout(n,500));const o=t.dataSources.filter(n=>n.selected);l("confirm",o),j.success(`å·²ç¡®è®¤é€‰æ‹© ${o.length} ä¸ªæ•°æ®æº`),r.value=!1,l("update:modelValue",!1)}finally{K.value=!1}};se(r,o=>{l("update:modelValue",o)});const f=o=>{if(r.value)switch(o.key){case"Escape":O();break;case"Enter":(o.ctrlKey||o.metaKey)&&ge();break;case"a":(o.ctrlKey||o.metaKey)&&(o.preventDefault(),de());break}};return se(r,o=>{o?document.addEventListener("keydown",f):document.removeEventListener("keydown",f)}),(o,n)=>{const U=w("el-tooltip"),De=w("el-input"),D=w("el-button"),ne=w("el-button-group"),fe=w("el-tag"),ze=w("el-option"),qe=w("el-select"),Pe=w("el-alert"),Be=w("el-skeleton"),Ke=w("el-progress"),Le=w("el-result"),Y=w("el-dropdown-item"),Ve=w("el-dropdown-menu"),Ae=w("el-dropdown"),Oe=w("el-checkbox"),Fe=w("el-dialog");return h(),H(Fe,{modelValue:r.value,"onUpdate:modelValue":n[8]||(n[8]=y=>r.value=y),title:"æ•°æ®æºé€‰æ‹©ï¼ˆå·²é€‰ï¼š"+z.value+"å¼ è¡¨ï¼‰",width:"600px","before-close":O,"destroy-on-close":!0,class:"data-source-selector-dialog","close-on-click-modal":!1,"close-on-press-escape":!0,"append-to-body":""},{footer:u(()=>[s("div",sa,[s("div",oa,[z.value>0?(h(),H(fe,{key:0,type:"success",size:"large"},{default:u(()=>[s("el-icon",null,[d($(Re))]),v(" å·²é€‰æ‹© "+S(z.value)+" ä¸ªæ•°æ®æº ",1)]),_:1})):(h(),g("span",na,"è¯·é€‰æ‹©æ•°æ®æº"))]),s("div",la,[d(D,{onClick:O,size:"large"},{default:u(()=>[...n[29]||(n[29]=[v(" å–æ¶ˆ ",-1)])]),_:1}),d(D,{type:"primary",size:"large",onClick:ge,disabled:z.value===0,loading:K.value},{default:u(()=>[K.value?I("",!0):(h(),g("el-icon",ra,[d($(Re))])),n[30]||(n[30]=v(" ç¡®å®šé€‰æ‹© ",-1))]),_:1},8,["disabled","loading"])])])]),default:u(()=>[s("div",kt,[d(De,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=y=>c.value=y),placeholder:"è¯·è¾“å…¥æ•°æ®æºåç§°æœç´¢...","prefix-icon":"Search",clearable:"",class:"search-input",onKeyup:Me(k,["enter"]),onClear:G},{suffix:u(()=>[d(U,{content:"æ”¯æŒæ¨¡ç³Šæœç´¢å’Œæ­£åˆ™è¡¨è¾¾å¼",placement:"top"},{default:u(()=>[s("el-icon",Tt,[d($(Je))])]),_:1})]),_:1},8,["modelValue"]),s("div",Dt,[d(ne,null,{default:u(()=>[d(D,{type:p.value==="all"?"primary":"default",size:"small",onClick:n[1]||(n[1]=y=>Q("all"))},{default:u(()=>[v(" å…¨éƒ¨ ("+S(C.value)+") ",1)]),_:1},8,["type"]),d(D,{type:p.value==="selected"?"primary":"default",size:"small",onClick:n[2]||(n[2]=y=>Q("selected"))},{default:u(()=>[v(" å·²é€‰ ("+S(z.value)+") ",1)]),_:1},8,["type"]),d(D,{type:p.value==="pinned"?"primary":"default",size:"small",onClick:n[3]||(n[3]=y=>Q("pinned"))},{default:u(()=>[v(" ç½®é¡¶ ("+S(V.value)+") ",1)]),_:1},8,["type"])]),_:1}),d(qe,{modelValue:m.value,"onUpdate:modelValue":n[4]||(n[4]=y=>m.value=y),multiple:"",placeholder:"ç­›é€‰ç±»å‹",size:"small",style:{width:"120px"},"collapse-tags":"","collapse-tags-tooltip":""},{default:u(()=>[(h(!0),g(P,null,B(X.value,y=>(h(),H(ze,{key:y.value,label:y.label,value:y.value},{default:u(()=>[d(fe,{type:N(y.value),size:"small"},{default:u(()=>[v(S(y.label),1)]),_:2},1032,["type"])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),z.value>0?(h(),g("div",xt,[d(Pe,{title:`å·²é€‰æ‹© ${z.value} ä¸ªæ•°æ®æº`,type:"info",closable:!1,"show-icon":""},{default:u(()=>[s("div",$t,[d(D,{size:"small",onClick:de},{default:u(()=>[...n[9]||(n[9]=[v("å…¨é€‰",-1)])]),_:1}),d(D,{size:"small",onClick:ke},{default:u(()=>[...n[10]||(n[10]=[v("æ¸…ç©º",-1)])]),_:1}),d(D,{size:"small",onClick:ue},{default:u(()=>[...n[11]||(n[11]=[v("åé€‰",-1)])]),_:1}),d(D,{size:"small",onClick:he},{default:u(()=>[...n[12]||(n[12]=[v("æ‰¹é‡ç½®é¡¶",-1)])]),_:1})])]),_:1},8,["title"])])):I("",!0),e.isLoading?(h(),g("div",Mt,[s("div",Lt,[d(Be,{rows:5,animated:""}),s("div",Vt,[d(Ke,{percentage:M.value,"show-text":!1,"stroke-width":4,color:"#409eff"},null,8,["percentage"])])]),s("div",At,[s("el-icon",It,[d($(Qe))]),n[13]||(n[13]=v(" æ­£åœ¨åŠ è½½æ•°æ®æº... ",-1))])])):e.error?(h(),g("div",Ut,[d(Le,{icon:"warning",title:"åŠ è½½å¤±è´¥","sub-title":e.error},{extra:u(()=>[s("div",Rt,[d(D,{type:"primary",onClick:Te},{default:u(()=>[s("el-icon",null,[d($(Ge))]),n[14]||(n[14]=v(" é‡æ–°åŠ è½½ ",-1))]),_:1}),d(D,{onClick:O},{default:u(()=>[...n[15]||(n[15]=[v(" å–æ¶ˆ ",-1)])]),_:1})])]),_:1},8,["sub-title"])])):(h(),g("div",Et,[E.value.length===0?(h(),g("div",Ht,[d(Le,{icon:c.value?"search":"info",title:_(),"sub-title":i()},{extra:u(()=>[s("div",zt,[c.value?(h(),H(D,{key:0,type:"primary",onClick:G},{default:u(()=>[s("el-icon",null,[d($(We))]),n[16]||(n[16]=v(" æ¸…ç©ºæœç´¢ ",-1))]),_:1})):p.value!=="all"?(h(),H(D,{key:1,onClick:n[5]||(n[5]=y=>Q("all"))},{default:u(()=>[s("el-icon",null,[d($(Ie))]),n[17]||(n[17]=v(" æŸ¥çœ‹å…¨éƒ¨ ",-1))]),_:1})):(h(),H(D,{key:2,onClick:O},{default:u(()=>[s("el-icon",null,[d($(Xe))]),n[18]||(n[18]=v(" æ·»åŠ æ•°æ®æº ",-1))]),_:1}))])]),_:1},8,["icon","title","sub-title"])])):(h(),g("div",qt,[s("div",Pt,[s("div",Bt,[v(" æ˜¾ç¤º "+S(E.value.length)+" ä¸ªæ•°æ®æº ",1),c.value?(h(),g("span",Kt,'ï¼ˆæœç´¢ï¼š"'+S(c.value)+'"ï¼‰',1)):I("",!0)]),s("div",Ot,[d(Ae,{onCommand:we},{dropdown:u(()=>[d(Ve,null,{default:u(()=>[d(Y,{command:"name"},{default:u(()=>[...n[20]||(n[20]=[v("æŒ‰åç§°",-1)])]),_:1}),d(Y,{command:"type"},{default:u(()=>[...n[21]||(n[21]=[v("æŒ‰ç±»å‹",-1)])]),_:1}),d(Y,{command:"selected"},{default:u(()=>[...n[22]||(n[22]=[v("æŒ‰é€‰æ‹©çŠ¶æ€",-1)])]),_:1}),d(Y,{command:"pinned"},{default:u(()=>[...n[23]||(n[23]=[v("æŒ‰ç½®é¡¶çŠ¶æ€",-1)])]),_:1})]),_:1})]),default:u(()=>[d(D,{size:"small",text:""},{default:u(()=>[n[19]||(n[19]=v(" æ’åº ",-1)),s("el-icon",null,[d($(Ye))])]),_:1})]),_:1})])]),s("div",Ft,[d(at,{name:"table-item",tag:"div"},{default:u(()=>[(h(!0),g(P,null,B(F.value,y=>(h(),g("div",{key:y.id,class:$e(["table-item",{selected:y.selected,pinned:y.pinned,highlighted:L.value===y.id}]),onClick:W=>Se(y),onMouseenter:W=>be(y),onMouseleave:n[7]||(n[7]=W=>Ce())},[d(Oe,{"model-value":y.selected,label:y.id,class:"table-checkbox",onChange:W=>ce(y,W),onClick:n[6]||(n[6]=re(()=>{},["stop"]))},{default:u(()=>[s("div",jt,[s("div",Jt,[s("span",Qt,S(ve(y.name)),1),s("div",Gt,[d(fe,{type:N(y.type),size:"small",class:"type-tag"},{default:u(()=>[v(S(q(y.type)),1)]),_:2},1032,["type"]),y.pinned?(h(),g("el-icon",Wt,[d($(Ue))])):I("",!0),y.selected?(h(),H(fe,{key:1,type:"success",size:"small"},{default:u(()=>[...n[24]||(n[24]=[v(" å·²é€‰ ",-1)])]),_:1})):I("",!0)])]),s("div",Xt,[s("span",Yt,"ID: "+S(y.id),1),s("span",Zt,[s("el-icon",{color:y.isActive?"#67c23a":"#909399"},[y.isActive?(h(),H($(Ze),{key:0})):(h(),H($(et),{key:1}))],8,ea),v(" "+S(y.isActive?"æ´»è·ƒ":"éæ´»è·ƒ"),1)])])])]),_:2},1032,["model-value","label","onChange"]),s("div",ta,[d(U,{content:"ç½®é¡¶/å–æ¶ˆç½®é¡¶",placement:"top"},{default:u(()=>[d(D,{type:"text",size:"small",onClick:re(W=>pe(y),["stop"]),class:$e({pinned:y.pinned})},{default:u(()=>[s("el-icon",{color:y.pinned?"#f56c6c":"#909399"},[d($(Ue))],8,aa)]),_:2},1032,["onClick","class"])]),_:2},1024),d(U,{content:"é¢„è§ˆæ•°æ®",placement:"top"},{default:u(()=>[d(D,{type:"primary",size:"small",class:"preview-btn",onClick:re(W=>ee(y),["stop"])},{default:u(()=>[s("el-icon",null,[d($(Ie))]),n[25]||(n[25]=v(" é¢„è§ˆ ",-1))]),_:1},8,["onClick"])]),_:2},1024),d(Ae,{onCommand:W=>me(y,W)},{dropdown:u(()=>[d(Ve,null,{default:u(()=>[d(Y,{command:"info"},{default:u(()=>[...n[26]||(n[26]=[v("æŸ¥çœ‹è¯¦æƒ…",-1)])]),_:1}),d(Y,{command:"copy"},{default:u(()=>[...n[27]||(n[27]=[v("å¤åˆ¶ID",-1)])]),_:1}),d(Y,{command:"export"},{default:u(()=>[...n[28]||(n[28]=[v("å¯¼å‡ºé…ç½®",-1)])]),_:1})]),_:1})]),default:u(()=>[d(D,{type:"text",size:"small"},{default:u(()=>[s("el-icon",null,[d($(tt))])]),_:1})]),_:1},8,["onCommand"])])],42,Nt))),128))]),_:1})])]))]))]),_:1},8,["modelValue","title"])}}}),ca=ie(ia,[["__scopeId","data-v-e462ee99"]]),da={key:0,class:"schema-preview"},ua={class:"field-details"},ha={class:"detail-item"},pa={class:"detail-item"},ma={class:"detail-item"},ga={class:"detail-item"},fa={class:"detail-item"},ya={class:"detail-item"},_a={key:1,class:"data-preview"},va={class:"cell-content"},wa={class:"cell-text",style:{"max-width":"300px","word-wrap":"break-word","white-space":"normal"}},Sa={key:0,class:"pagination-info"},ba={key:2,class:"multi-table-tip"},Ca={key:3,class:"no-data"},ka={__name:"DataPreviewModal",props:{modelValue:{type:Boolean,default:!1},previewData:{type:Object,default:()=>({schema:[],data:[]})},isMultiTable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:a}){const t=e,l=a,r=x(t.modelValue),c=x("schema"),p=x(""),m=A(()=>t.isMultiTable?"å¤šè¡¨é¢„è§ˆï¼ˆæ˜¾ç¤ºç¬¬ä¸€ä¸ªè¡¨ï¼‰":t.previewData.schema&&t.previewData.schema.length>0&&t.previewData.schema[0].name||"æ•°æ®é¢„è§ˆ"),R=A(()=>window.innerHeight-200);se(()=>t.modelValue,M=>{r.value=M});const L=()=>{r.value=!1,l("update:modelValue",!1)},K=M=>{c.value=M.name};return se(r,M=>{l("update:modelValue",M)}),(M,C)=>{const V=w("el-tab-pane"),X=w("el-tabs"),E=w("el-collapse-item"),F=w("el-collapse"),z=w("el-table-column"),J=w("el-table"),oe=w("el-alert"),O=w("el-button"),Q=w("el-dialog");return h(),H(Q,{modelValue:r.value,"onUpdate:modelValue":C[2]||(C[2]=k=>r.value=k),title:m.value,width:"90%",fullscreen:!0,"before-close":L,"destroy-on-close":!0,class:"data-preview-modal","modal-append-to-body":!0},{footer:u(()=>[d(O,{onClick:L},{default:u(()=>[...C[10]||(C[10]=[v("å…³é—­",-1)])]),_:1})]),default:u(()=>[d(X,{modelValue:c.value,"onUpdate:modelValue":C[0]||(C[0]=k=>c.value=k),class:"preview-tabs",onTabClick:K},{default:u(()=>[d(V,{label:"å­—æ®µé¢„è§ˆ",name:"schema"}),d(V,{label:"æ•°æ®é¢„è§ˆ",name:"data"})]),_:1},8,["modelValue"]),c.value==="schema"?(h(),g("div",da,[(h(!0),g(P,null,B(e.previewData.schema,k=>(h(),g("div",{key:k.name,class:"field-item"},[d(F,{modelValue:p.value,"onUpdate:modelValue":C[1]||(C[1]=G=>p.value=G),accordion:""},{default:u(()=>[d(E,{title:k.name+" ("+k.type+")",name:k.name},{default:u(()=>[s("div",ua,[s("div",ha,[C[3]||(C[3]=s("span",{class:"label"},"å­—æ®µåï¼š",-1)),s("span",null,S(k.name),1)]),s("div",pa,[C[4]||(C[4]=s("span",{class:"label"},"ç±»å‹ï¼š",-1)),s("span",null,S(k.type),1)]),s("div",ma,[C[5]||(C[5]=s("span",{class:"label"},"æè¿°ï¼š",-1)),s("span",null,S(k.description||"æ— æè¿°"),1)]),s("div",ga,[C[6]||(C[6]=s("span",{class:"label"},"å•ä½ï¼š",-1)),s("span",null,S(k.unit||"æ— "),1)]),s("div",fa,[C[7]||(C[7]=s("span",{class:"label"},"ç±»åˆ«ï¼š",-1)),s("span",null,S(k.category||"æ— "),1)]),s("div",ya,[C[8]||(C[8]=s("span",{class:"label"},"æ˜¯å¦ä¸»é”®ï¼š",-1)),s("span",null,S(k.isPrimaryKey?"æ˜¯":"å¦"),1)])])]),_:2},1032,["title","name"])]),_:2},1032,["modelValue"])]))),128))])):I("",!0),c.value==="data"?(h(),g("div",_a,[d(J,{data:e.previewData.data,style:{width:"100%"},"max-height":R.value,border:"","highlight-current-row":"",class:"data-table"},{default:u(()=>[(h(!0),g(P,null,B(e.previewData.schema,k=>(h(),H(z,{key:k.name,prop:k.name,label:k.name,"min-width":k.minWidth||120,width:k.width||null,"show-overflow-tooltip":!0,"class-name":"table-column"},{default:u(G=>[s("div",va,[s("span",wa,S(G.row[k.name]||"-"),1)])]),_:2},1032,["prop","label","min-width","width"]))),128))]),_:1},8,["data","max-height"]),e.previewData.data&&e.previewData.data.length>0?(h(),g("div",Sa," å…± "+S(e.previewData.data.length)+" æ¡è®°å½• ",1)):I("",!0)])):I("",!0),e.isMultiTable?(h(),g("div",ba,[d(oe,{title:"å·²é€‰æ‹©å¤šä¸ªæ•°æ®è¡¨ï¼Œæ˜¾ç¤ºç¬¬ä¸€ä¸ªè¡¨çš„é¢„è§ˆæ•°æ®",type:"info","show-icon":"",closable:!1})])):I("",!0),!e.previewData.data||e.previewData.data.length===0?(h(),g("div",Ca,[...C[9]||(C[9]=[s("p",null,"æš‚æ— æ•°æ®å¯é¢„è§ˆ",-1)])])):I("",!0)]),_:1},8,["modelValue","title"])}}},Ta=ie(ka,[["__scopeId","data-v-c6924e7d"]]),Z={getAll(){return b.get("/data-sources").then(e=>e.data)},getById(e){return b.get(`/data-sources/${e}`).then(a=>a.data)},create(e){return b.post("/data-sources",e).then(a=>a.data)},update(e,a){return b.put(`/data-sources/${e}`,a).then(t=>t.data)},delete(e){return b.delete(`/data-sources/${e}`).then(a=>a.data)},testConnection(e){return b.post("/data-sources/test",e).then(a=>a.data)},activate(e){return b.put(`/data-sources/${e}/activate`).then(a=>a.data)},uploadExcel(e){const a=new FormData;return a.append("file",e),b.post("/data-sources/upload",a,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>t.data)},export(e,a){return b.get(`/data-sources/${e}/download`,{params:{format:a}}).then(t=>t.data)}},ye={getAll(){return b.get("/dictionaries").then(e=>e.data)},getByTableAndField(e,a){return b.get("/dictionaries",{params:{table_name:e,field_name:a}}).then(t=>t.data)},getById(e){return b.get(`/dictionaries/${e}`).then(a=>a.data)},create(e){return b.post("/dictionaries",e).then(a=>a.data)},update(e,a){return b.put(`/dictionaries/${e}`,a).then(t=>t.data)},delete(e){return b.delete(`/dictionaries/${e}`).then(a=>a.data)},export(e,a){return b.get(`/dictionaries/${e}/download`,{params:{format:a}}).then(t=>t.data)}},ae={getAll:async(e,a,t,l=1,r=10)=>{const c=new URLSearchParams;return e&&c.append("primary_table_id",e),a&&c.append("foreign_table_id",a),t!==void 0&&c.append("status",t.toString()),c.append("skip",((l-1)*r).toString()),c.append("limit",r.toString()),(await b.get("/table-relations",{params:c})).data.map(m=>({id:m.id,source_table:m.primary_table_name,source_column:m.primary_field_name,target_table:m.foreign_table_name,target_column:m.foreign_field_name,relation_type:_e(m.join_type),is_active:m.status,created_at:m.created_at}))},get:async e=>{const t=(await b.get(`/api/table-relations/${e}`)).data;return{id:t.id,source_table:t.primary_table_name,source_column:t.primary_field_name,target_table:t.foreign_table_name,target_column:t.foreign_field_name,relation_type:_e(t.join_type),is_active:t.status,created_at:t.created_at}},create:async e=>{const t=(await b.post("/table-relations",{relation_name:`${e.source_table_id} -> ${e.target_table_id}`,primary_table_id:e.source_table_id,primary_field_id:e.source_column_id,foreign_table_id:e.target_table_id,foreign_field_id:e.target_column_id,join_type:Ee(e.relation_type),description:e.description,created_by:"user"})).data;return{id:t.id,source_table:t.primary_table_name,source_column:t.primary_field_name,target_table:t.foreign_table_name,target_column:t.foreign_field_name,relation_type:_e(t.join_type),is_active:t.status,created_at:t.created_at}},update:async(e,a)=>{const t={};a.source_table_id&&(t.primary_table_id=a.source_table_id),a.source_column_id&&(t.primary_field_id=a.source_column_id),a.target_table_id&&(t.foreign_table_id=a.target_table_id),a.target_column_id&&(t.foreign_field_id=a.target_column_id),a.relation_type&&(t.join_type=Ee(a.relation_type)),a.description!==void 0&&(t.description=a.description),a.is_active!==void 0&&(t.status=a.is_active);const r=(await b.put(`/api/table-relations/${e}`,t)).data;return{id:r.id,source_table:r.primary_table_name,source_column:r.primary_field_name,target_table:r.foreign_table_name,target_column:r.foreign_field_name,relation_type:_e(r.join_type),is_active:r.status,created_at:r.created_at}},delete:async e=>{await b.delete(`/api/table-relations/${e}`)},deleteMultiple:async e=>{const a=e.map(t=>ae.delete(t));await Promise.all(a)}};function Ee(e){switch(e){case"one_to_one":return"INNER";case"one_to_many":return"LEFT";case"many_to_one":return"RIGHT";case"many_to_many":return"FULL";default:return"INNER"}}function _e(e){switch(e.toUpperCase()){case"INNER":return"one_to_one";case"LEFT":return"one_to_many";case"RIGHT":return"many_to_one";case"FULL":return"many_to_many";default:return"one_to_one"}}const Da=He("dataPrep",{state:()=>({dataSources:[],activeDataSourceId:null,dataTables:[],dictionaries:[],connectionTestResult:null,permissions:{query:!0,report:!0,export:!0},tablePermissions:[],dataSourceCache:null,dataTableCache:new Map,dictionaryCache:null,tableRelations:[],preloadStatus:{dataSources:!1,dataTables:!1,dictionaries:!1},performanceMetrics:{lastLoadTime:0,averageLoadTime:0,loadCount:0,cacheHitRate:0,totalCacheHits:0,totalCacheRequests:0},isLoading:!1,error:null,isLoadingDataSources:!1,dataSourceError:null}),getters:{activeDataSource:e=>e.dataSources.find(a=>a.id===e.activeDataSourceId)||null,hasActiveDataSource:e=>e.activeDataSourceId!==null,getTablesBySourceId:e=>a=>e.dataTables.filter(t=>t.sourceId===a),mapValue:e=>(a,t,l)=>{if(e.dictionaryCache?.byTable){const c=e.dictionaryCache.byTable.get(t);if(c){const p=c.find(m=>m.fieldName===l&&m.key===String(a));return p?p.value:String(a)}}const r=e.dictionaries.find(c=>c.tableName===t&&c.fieldName===l&&c.key===String(a));return r?r.value:String(a)},getCacheEfficiency:e=>{const{totalCacheHits:a,totalCacheRequests:t}=e.performanceMetrics;return t>0?a/t*100:0},getPreloadProgress:e=>{const{dataSources:a,dataTables:t,dictionaries:l}=e.preloadStatus;return[a,t,l].filter(Boolean).length/3*100}},actions:{async loadDataSources(e=!1){const a=performance.now(),t=T();if(this.performanceMetrics.totalCacheRequests++,!e&&this.isDataSourceCacheValid()){this.dataSources=[...this.dataSourceCache.data];const l=this.dataSources.find(r=>r.isActive);l&&(this.activeDataSourceId=l.id),this.performanceMetrics.totalCacheHits++,this.updateCacheHitRate();return}this.isLoadingDataSources=!0,this.dataSourceError=null;try{const l=await Z.getAll(),r=Array.isArray(l)?l:[];this.dataSources=r.map(m=>({...m,createdAt:m.createdAt?new Date(m.createdAt).toISOString():new Date().toISOString(),updatedAt:m.updatedAt?new Date(m.updatedAt).toISOString():new Date().toISOString()}));const c=this.dataSources.find(m=>m.isActive);c&&(this.activeDataSourceId=c.id),this.updateDataSourceCache(this.dataSources);const p=performance.now()-a;this.updatePerformanceMetrics(p),this.preloadStatus.dataSources=!0,this.preloadRelatedData()}catch(l){const r=l?.response?.data?.detail||l?.message||"åŠ è½½æ•°æ®æºå¤±è´¥";this.dataSourceError=r,console.error("DataPrep Store - loadDataSources é”™è¯¯:",{message:r,status:l?.response?.status,statusText:l?.response?.statusText,url:l?.config?.url,timestamp:new Date().toISOString(),loadTime:performance.now()-a}),t.showToast(`æ•°æ®æºåŠ è½½å¤±è´¥: ${r}`,"error")}finally{this.isLoadingDataSources=!1}},async preloadRelatedData(){this.activeDataSourceId&&!this.preloadStatus.dataTables&&this.loadDataTables(this.activeDataSourceId).catch(e=>{console.warn("é¢„åŠ è½½æ•°æ®è¡¨å¤±è´¥:",e)}),this.preloadStatus.dictionaries||this.loadDictionaries().catch(e=>{console.warn("é¢„åŠ è½½å­—å…¸æ•°æ®å¤±è´¥:",e)})},updateDataSourceCache(e){const a=this.dataSourceCache?.version||0;this.dataSourceCache={data:[...e],timestamp:new Date,version:a+1}},updatePerformanceMetrics(e){const a=this.performanceMetrics;a.lastLoadTime=e,a.loadCount++,a.loadCount===1?a.averageLoadTime=e:a.averageLoadTime=a.averageLoadTime*.8+e*.2,this.updateCacheHitRate()},updateCacheHitRate(){const{totalCacheHits:e,totalCacheRequests:a}=this.performanceMetrics;this.performanceMetrics.cacheHitRate=a>0?e/a*100:0},updatePermission(e,a){this.permissions[e]=a,console.log("Permission updated:",e,a)},updateTablePermissions(e){this.tablePermissions=e,console.log("Table permissions updated:",e)},async createDataSource(e){const a=T();try{const t=await Z.create(e);return this.dataSources.push({...t,createdAt:t.createdAt?t.createdAt:new Date().toISOString(),updatedAt:t.updatedAt?t.updatedAt:new Date().toISOString()}),a.showToast("æ•°æ®æºåˆ›å»ºæˆåŠŸ","success"),t}catch(t){throw a.showToast(t?.message||"Unknown error","error"),t}},async updateDataSource(e,a){const t=T();try{const l=await Z.update(e,a),r=this.dataSources.findIndex(c=>c.id===e);r!==-1&&(this.dataSources[r]={...l,createdAt:l.createdAt,updatedAt:l.updatedAt}),t.showToast("æ•°æ®æºæ›´æ–°æˆåŠŸ","success")}catch(l){throw t.showToast(l?.message||"Unknown error","error"),l}},async deleteDataSource(e){const a=T();try{await Z.delete(e),this.dataSources=this.dataSources.filter(t=>t.id!==e),this.activeDataSourceId===e&&(this.activeDataSourceId=this.dataSources[0]?.id||null),a.showToast("æ•°æ®æºå·²åˆ é™¤","success")}catch(t){throw a.showToast(t?.message||"Unknown error","error"),t}},async testConnection(e){const a=T();this.connectionTestResult=null;try{const t=await Z.testConnection(e);return this.connectionTestResult=t,t.success?a.showToast("è¿æ¥æµ‹è¯•æˆåŠŸ","success"):a.showToast(`è¿æ¥å¤±è´¥ï¼š${t.message}`,"error"),t}catch(t){const l={success:!1,message:t?.message||"Unknown error"};return this.connectionTestResult=l,a.showToast(`è¿æ¥æµ‹è¯•å¤±è´¥ï¼š${t?.message||"Unknown error"}`,"error"),l}},async activateDataSource(e){const a=T();try{const t=await Z.activate(e);this.dataSources=this.dataSources.map(l=>({...l,isActive:l.id===e})),this.activeDataSourceId=e,a.showToast("æ•°æ®æºå·²æ¿€æ´»","success")}catch(t){throw a.showToast(t?.message||"Unknown error","error"),t}},async uploadExcelFile(e){const a=T();a.setLoading(!0,"æ­£åœ¨ä¸Šä¼ æ–‡ä»¶...");try{const t=await Z.uploadExcel(e);return this.dataSources.push({...t,createdAt:t.createdAt,updatedAt:t.updatedAt}),await this.activateDataSource(t.id),a.showToast("æ–‡ä»¶ä¸Šä¼ æˆåŠŸ","success"),t}catch(t){throw a.showToast(t?.message||"Unknown error","error"),t}finally{a.setLoading(!1)}},async loadDataTables(e,a=!0){const t=T(),l=e||"all";if(a&&this.dataTableCache.has(l)){const r=this.dataTableCache.get(l);if(Date.now()-r.timestamp.getTime()<600*1e3){this.dataTables=[...r.data],this.preloadStatus.dataTables=!0;return}}try{let r;e?r=await xe.getBySourceId(e):r=await xe.getAll(),this.dataTables=r,this.dataTableCache.set(l,{data:[...r],timestamp:new Date,sourceId:e||"all"}),this.preloadStatus.dataTables=!0}catch(r){t.showToast(r?.message||"Unknown error","error")}},async syncTableStructure(e){const a=T();a.setLoading(!0,"æ­£åœ¨åŒæ­¥è¡¨ç»“æ„...");try{const t=await xe.syncStructure(e),l=this.dataTables.findIndex(r=>r.id===e);l!==-1&&(this.dataTables[l]=t),a.showToast("è¡¨ç»“æ„åŒæ­¥æˆåŠŸ","success")}catch(t){throw a.showToast(t?.message||"Unknown error","error"),t}finally{a.setLoading(!1)}},async loadDictionaries(e=!0){const a=T();if(e&&this.dictionaryCache&&Date.now()-this.dictionaryCache.timestamp.getTime()<900*1e3){this.dictionaries=[...this.dictionaryCache.data],this.preloadStatus.dictionaries=!0;return}try{const t=await ye.getAll();this.dictionaries=t;const l=new Map;t.forEach(r=>{l.has(r.tableName)||l.set(r.tableName,[]),l.get(r.tableName).push(r)}),this.dictionaryCache={data:[...t],timestamp:new Date,byTable:l},this.preloadStatus.dictionaries=!0}catch(t){a.showToast(t?.message||"Unknown error","error")}},async createDictionaryEntry(e){const a=T();try{const t=await ye.create(e);this.dictionaries.push(t),a.showToast("å­—å…¸æ¡ç›®åˆ›å»ºæˆåŠŸ","success")}catch(t){throw a.showToast(t?.message||"Unknown error","error"),t}},async updateDictionaryEntry(e,a){const t=T();try{const l=await ye.update(e,a),r=this.dictionaries.findIndex(c=>c.id===e);r!==-1&&(this.dictionaries[r]=l),t.showToast("å­—å…¸æ¡ç›®æ›´æ–°æˆåŠŸ","success")}catch(l){throw t.showToast(l?.message||"Unknown error","error"),l}},async deleteDictionaryEntry(e){const a=T();try{await ye.delete(e),this.dictionaries=this.dictionaries.filter(t=>t.id!==e),a.showToast("å­—å…¸æ¡ç›®å·²åˆ é™¤","success")}catch(t){throw a.showToast(t?.message||"Unknown error","error"),t}},clearAllCaches(){this.dataSourceCache=null,this.dataTableCache.clear(),this.dictionaryCache=null,this.preloadStatus={dataSources:!1,dataTables:!1,dictionaries:!1},console.log("æ‰€æœ‰ç¼“å­˜å·²æ¸…ç©º")},invalidateCache(e,a){switch(e){case"dataSources":this.dataSourceCache=null,this.preloadStatus.dataSources=!1;break;case"dataTables":a?this.dataTableCache.delete(a):this.dataTableCache.clear(),this.preloadStatus.dataTables=!1;break;case"dictionaries":this.dictionaryCache=null,this.preloadStatus.dictionaries=!1;break;case"all":this.clearAllCaches();break}console.log(`ç¼“å­˜å¤±æ•ˆ: ${e}${a?` (${a})`:""}`)},async warmupCache(){console.log("å¼€å§‹ç¼“å­˜é¢„çƒ­...");const e=performance.now();try{await Promise.allSettled([this.loadDataSources(),this.loadDictionaries()]),this.activeDataSourceId&&await this.loadDataTables(this.activeDataSourceId);const a=performance.now()-e;console.log(`ç¼“å­˜é¢„çƒ­å®Œæˆï¼Œè€—æ—¶: ${a.toFixed(2)}ms`)}catch(a){console.error("ç¼“å­˜é¢„çƒ­å¤±è´¥:",a)}},clearDataSourceCache(){this.dataSourceCache=null,this.preloadStatus.dataSources=!1},resetDataSourceState(){this.dataSources=[],this.activeDataSourceId=null,this.isLoadingDataSources=!1,this.dataSourceError=null,this.dataSourceCache=null,this.preloadStatus.dataSources=!1},isDataSourceCacheValid(){if(!this.dataSourceCache)return!1;const e=Date.now()-this.dataSourceCache.timestamp.getTime(),a=300*1e3;return e<a},getCacheStats(){const e=this.dataSourceCache?.data.length||0,a=Array.from(this.dataTableCache.values()).reduce((l,r)=>l+r.data.length,0),t=this.dictionaryCache?.data.length||0;return{dataSources:{cached:!!this.dataSourceCache,size:e,age:this.dataSourceCache?Date.now()-this.dataSourceCache.timestamp.getTime():0},dataTables:{cacheCount:this.dataTableCache.size,totalSize:a},dictionaries:{cached:!!this.dictionaryCache,size:t,indexedTables:this.dictionaryCache?.byTable.size||0},performance:{...this.performanceMetrics}}},async fetchTableRelations(e,a,t,l=1,r=10){const c=T();c.setLoading(!0,"æ­£åœ¨åŠ è½½è¡¨å…³è”æ•°æ®...");try{const p=await ae.getAll(e,a,t,l,r);this.tableRelations=p}catch(p){throw c.showToast("è·å–è¡¨å…³è”æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•","error"),p}finally{c.setLoading(!1)}},async createTableRelation(e){const a=T();a.setLoading(!0,"æ­£åœ¨åˆ›å»ºè¡¨å…³è”...");try{const t=await ae.create(e);return this.tableRelations.push(t),a.showToast("è¡¨å…³è”åˆ›å»ºæˆåŠŸ","success"),t}catch(t){throw a.showToast("åˆ›å»ºè¡¨å…³è”å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•","error"),t}finally{a.setLoading(!1)}},async updateTableRelation(e,a){const t=T();t.setLoading(!0,"æ­£åœ¨æ›´æ–°è¡¨å…³è”...");try{const l=await ae.update(e,a),r=this.tableRelations.findIndex(c=>c.id===e);return r!==-1&&(this.tableRelations[r]=l),t.showToast("è¡¨å…³è”æ›´æ–°æˆåŠŸ","success"),l}catch(l){throw t.showToast("æ›´æ–°è¡¨å…³è”å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•","error"),l}finally{t.setLoading(!1)}},async deleteTableRelation(e){const a=T();a.setLoading(!0,"æ­£åœ¨åˆ é™¤è¡¨å…³è”...");try{await ae.delete(e),this.tableRelations=this.tableRelations.filter(t=>t.id!==e),a.showToast("è¡¨å…³è”å·²åˆ é™¤","success")}catch(t){throw a.showToast("åˆ é™¤è¡¨å…³è”å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•","error"),t}finally{a.setLoading(!1)}},async deleteTableRelations(e){const a=T();a.setLoading(!0,"æ­£åœ¨æ‰¹é‡åˆ é™¤è¡¨å…³è”...");try{await ae.deleteMultiple(e),this.tableRelations=this.tableRelations.filter(t=>!e.includes(t.id)),a.showToast(`æˆåŠŸåˆ é™¤ ${e.length} ä¸ªè¡¨å…³è”`,"success")}catch(t){throw a.showToast("æ‰¹é‡åˆ é™¤è¡¨å…³è”å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•","error"),t}finally{a.setLoading(!1)}}}}),xa={class:"home-container"},$a={class:"toolbar"},Ma={class:"toolbar-left"},La={class:"toolbar-item"},Va={class:"toolbar-item"},Aa={class:"toolbar-right"},Ia={style:{"margin-right":"4px"}},Ua={key:0,class:"welcome-section"},Ra={class:"recommended-questions"},Ea={class:"question-list"},Ha=["onClick"],za={key:1,class:"messages-container"},qa={class:"messages-list"},Pa={key:0,class:"message ai-message"},Ba={key:1,class:"message ai-message"},Ka={class:"message-content ai-content"},Oa={class:"error-message"},Fa={key:0,class:"message user-message"},Na={class:"message-content user-content"},ja={class:"message-actions"},Ja=["onClick"],Qa=["onClick"],Ga=["onClick"],Wa={key:1,class:"message ai-message"},Xa={class:"message-content ai-content"},Ya=["innerHTML"],Za={key:1,class:"chart-container"},es={key:2,class:"table-container"},ts={class:"message-actions"},as=["onClick"],ss=["onClick"],os=["onClick"],ns={key:2,class:"message ai-message"},ls={class:"message-content ai-content"},rs={class:"loading-indicator"},is={class:"input-container"},cs={class:"input-row",style:{display:"flex","align-items":"center",gap:"12px","margin-bottom":"12px"}},ds={class:"data-source-selector",style:{display:"flex","align-items":"center"}},us={class:"mode-toggle",style:{display:"flex","align-items":"center","margin-left":"auto"}},hs={class:"input-row"},ps={class:"input-row",style:{display:"flex","justify-content":"flex-end",gap:"12px","margin-top":"12px"}},ms=["disabled"],gs={__name:"Home",setup(e){const a=ct(),t=T();nt();const l=()=>{t.toggleConfigDrawer()},r=x(""),c=x([]),p=x("query"),m=x(!0),R=x(!1),L=x(!1),K=x(!1),M=x({schema:[],data:[]}),C=x(!1),V=Da(),X=A(()=>V.dataSources),E=A(()=>V.isLoadingDataSources||t.isLoading),F=A(()=>V.dataSourceError),z=x(["2023å¹´å„å•†å“ç±»åˆ«çš„é”€å”®é¢æ˜¯å¤šå°‘ï¼Ÿ","2024å¹´æ¯›åˆ©æœ€é«˜çš„äº§å“æ˜¯ä»€ä¹ˆï¼Ÿ","æœ€è¿‘7å¤©çš„é”€å”®è¶‹åŠ¿å¦‚ä½•ï¼Ÿ","å„åŒºåŸŸçš„é”€å”®å¯¹æ¯”æƒ…å†µ","å®¢æˆ·è½¬åŒ–ç‡çš„å˜åŒ–è¶‹åŠ¿"]),J=A(()=>a.messages),oe=A(()=>J.value&&J.value.length>0);A(()=>c.value?p.value==="query"?"è¾“å…¥æ‚¨çš„é—®é¢˜ï¼Œè®© AI åˆ†ææ•°æ®...":"è¾“å…¥æ‚¨æƒ³è¦ç”Ÿæˆçš„æŠ¥å‘Šå†…å®¹...":"è¯·å…ˆé€‰æ‹©æ•°æ®æº...");const O=A(()=>r.value.trim().length>0&&c.value),Q=_=>_?_.replace(/\n/g,"<br>"):"",k=_=>{_.preventDefault();const i=_.target,q=i.selectionStart,N=i.selectionEnd,ee=i.value;i.value=ee.substring(0,q)+`
`+ee.substring(N),i.selectionStart=i.selectionEnd=q+1},G=_=>{r.value=_},ve=()=>{X.value.forEach(_=>{_.selected=c.value.includes(_.id)}),L.value=!0},we=_=>{c.value=_.map(i=>i.id),a.setDataSource(c.value),L.value=!1},Se=_=>{M.value={schema:[{name:"id",type:"int",description:"ä¸»é”®ID",unit:"",category:"æ ‡è¯†",isPrimaryKey:!0},{name:"name",type:"varchar",description:"å§“å",unit:"",category:"æ ‡è¯†",isPrimaryKey:!1},{name:"age",type:"int",description:"å¹´é¾„",unit:"å²",category:"äººå£",isPrimaryKey:!1},{name:"email",type:"varchar",description:"é‚®ç®±åœ°å€",unit:"",category:"è”ç³»æ–¹å¼",isPrimaryKey:!1},{name:"created_at",type:"datetime",description:"åˆ›å»ºæ—¶é—´",unit:"",category:"æ—¶é—´",isPrimaryKey:!1}],data:[{id:1,name:"å¼ ä¸‰",age:25,email:"zhangsan@example.com",created_at:"2023-01-15 10:30:00"},{id:2,name:"æå››",age:30,email:"lisi@example.com",created_at:"2023-02-20 14:45:00"},{id:3,name:"ç‹äº”",age:28,email:"wangwu@example.com",created_at:"2023-03-10 09:15:00"}]},K.value=!0},be=()=>{V.resetDataSourceState(),V.loadDataSources()},Ce=()=>{const _=document.getElementById("file-upload");_&&_.click()},ce=_=>{const i=_.target.files[0];if(i){const q=[".csv",".xlsx",".xls",".txt",".json"],N=i.name.substring(i.name.lastIndexOf("."));if(!q.includes(N.toLowerCase())){console.warn("ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹:",i.name),alert("ä»…æ”¯æŒ .csv, .xlsx, .xls, .txt, .json æ–‡ä»¶æ ¼å¼"),_.target.value="";return}console.log("ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯:",{name:i.name,size:i.size,type:i.type,lastModified:i.lastModified}),_.target.value=""}},de=_=>{c.value=_,a.setDataSource(_)},ke=()=>{a.toggleChatMode()},ue=async()=>{O.value&&(await a.sendMessage(r.value),r.value="")},he=_=>{console.log("åˆ·æ–°æ¶ˆæ¯:",_)},pe=_=>{console.log("ç‚¹èµæ¶ˆæ¯:",_)},me=_=>{console.log("ç‚¹è¸©æ¶ˆæ¯:",_)};return ot(()=>{if(a.loadSessions(),a.loadHistory(),V.loadDataSources(),V.dataSources.length>0){const _=V.dataSources.find(i=>i.isActive);_?(c.value=[_.id],a.setDataSource([_.id])):(c.value=[V.dataSources[0].id],a.setDataSource([V.dataSources[0].id]))}}),(_,i)=>{const q=w("el-switch"),N=w("el-button"),ee=w("el-option"),Te=w("el-select"),ge=w("el-input");return h(),g("div",xa,[s("div",$a,[s("div",Ma,[s("div",La,[d(q,{modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=f=>m.value=f),"active-text":"æ•°æ®è§£è¯»","inactive-text":"","active-color":"#1890ff","inactive-color":"#ccc",size:"small"},null,8,["modelValue"])]),s("div",Va,[d(q,{modelValue:R.value,"onUpdate:modelValue":i[1]||(i[1]=f=>R.value=f),"active-text":"æ³¢åŠ¨å½’å› ","inactive-text":"","active-color":"#1890ff","inactive-color":"#ccc",size:"small"},null,8,["modelValue"])])]),s("div",Aa,[d(N,{class:"config-button",onClick:l},{default:u(()=>[s("el-icon",Ia,[d($(lt))]),i[7]||(i[7]=v(" é…ç½® ",-1))]),_:1})])]),oe.value?(h(),g("div",za,[s("div",qa,[E.value&&!F.value?(h(),g("div",Pa,[...i[10]||(i[10]=[s("div",{class:"avatar ai-avatar"},"ğŸ¤–",-1),s("div",{class:"message-content ai-content"},[s("div",{class:"loading-indicator"},[s("div",{class:"loading-dots"},[s("span",null,"."),s("span",null,"."),s("span",null,".")]),s("p",null,"æ­£åœ¨åŠ è½½æ•°æ®æº...")])],-1)])])):F.value?(h(),g("div",Ba,[i[11]||(i[11]=s("div",{class:"avatar ai-avatar"},"ğŸ¤–",-1)),s("div",Ka,[s("p",Oa,S(F.value),1)])])):I("",!0),(h(!0),g(P,null,B(J.value,f=>rt((h(),g("div",{key:f.id},[f.role==="user"?(h(),g("div",Fa,[i[15]||(i[15]=s("div",{class:"avatar user-avatar"},"ğŸ‘¤",-1)),s("div",Na,[s("p",null,S(f.content),1),s("div",ja,[s("button",{class:"action-btn",onClick:o=>he(f)},[...i[12]||(i[12]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})],-1)])],8,Ja),s("button",{class:"action-btn",onClick:o=>pe(f)},[...i[13]||(i[13]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"})],-1)])],8,Qa),s("button",{class:"action-btn",onClick:o=>me(f)},[...i[14]||(i[14]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"})],-1)])],8,Ga)])])])):(h(),g("div",Wa,[i[19]||(i[19]=s("div",{class:"avatar ai-avatar"},"ğŸ¤–",-1)),s("div",Xa,[f.content?(h(),g("p",{key:0,innerHTML:Q(f.content)},null,8,Ya)):I("",!0),f.chartType?(h(),g("div",Za,[d(_t,{"chart-title":f.chartTitle||"",data:f.chartData,"max-value":f.maxValue},null,8,["chart-title","data","max-value"])])):I("",!0),f.tableData?(h(),g("div",es,[d(Ct,{headers:f.tableHeaders||[],rows:f.tableData},null,8,["headers","rows"])])):I("",!0),s("div",ts,[s("button",{class:"action-btn",onClick:o=>he(f)},[...i[16]||(i[16]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})],-1)])],8,as),s("button",{class:"action-btn",onClick:o=>pe(f)},[...i[17]||(i[17]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"})],-1)])],8,ss),s("button",{class:"action-btn",onClick:o=>me(f)},[...i[18]||(i[18]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"})],-1)])],8,os)])])]))])),[[it,!E.value||F.value]])),128)),$(t).isLoading?(h(),g("div",ns,[i[21]||(i[21]=s("div",{class:"avatar ai-avatar"},"ğŸ¤–",-1)),s("div",ls,[s("div",rs,[i[20]||(i[20]=s("div",{class:"loading-dots"},[s("span",null,"."),s("span",null,"."),s("span",null,".")],-1)),s("p",null,S($(t).loadingMessage),1)])])])):I("",!0)])])):(h(),g("div",Ua,[i[9]||(i[9]=s("div",{class:"welcome-header"},[s("h1",null,"æ¬¢è¿ä½¿ç”¨ ChatBI"),s("p",null,"è®©æ¯ä¸ªäººéƒ½èƒ½åƒå¯¹è¯ä¸€æ ·åˆ†ææ•°æ®")],-1)),s("div",Ra,[i[8]||(i[8]=s("h3",null,"æ¨èé—®é¢˜",-1)),s("div",Ea,[(h(!0),g(P,null,B(z.value,(f,o)=>(h(),g("button",{key:o,class:"question-btn",onClick:n=>G(f)},S(f),9,Ha))),128))])])])),s("div",is,[s("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:ce,accept:".csv,.xlsx,.xls,.txt,.json"},null,32),s("div",cs,[s("div",ds,[i[22]||(i[22]=s("label",{class:"label"},"æ•°æ®æºï¼š",-1)),d(Te,{modelValue:c.value,"onUpdate:modelValue":i[2]||(i[2]=f=>c.value=f),placeholder:"è¯·é€‰æ‹©æ•°æ®æº",class:"source-select",multiple:"","collapse-tags":"",onChange:de},{default:u(()=>[(h(!0),g(P,null,B(X.value,f=>(h(),H(ee,{key:f.id,label:f.name,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),d(N,{type:"primary",size:"small",class:"preview-btn",onClick:ve},{default:u(()=>[...i[23]||(i[23]=[v(" é¢„è§ˆ ",-1)])]),_:1}),s("div",us,[i[24]||(i[24]=s("label",{class:"label",style:{"margin-right":"8px"}},"æ™ºèƒ½é—®æ•°",-1)),d(q,{modelValue:p.value,"onUpdate:modelValue":i[3]||(i[3]=f=>p.value=f),"active-text":"","inactive-text":"","active-color":"#1890ff","inactive-color":"#ccc",size:"small",onChange:ke},null,8,["modelValue"]),i[25]||(i[25]=s("label",{class:"label",style:{"margin-left":"8px"}},"ç”ŸæˆæŠ¥å‘Š",-1))])]),s("div",hs,[d(ge,{modelValue:r.value,"onUpdate:modelValue":i[4]||(i[4]=f=>r.value=f),placeholder:"è¾“å…¥æ‚¨çš„é—®é¢˜ï¼Œè®© AI åˆ†ææ•°æ®...",type:"textarea",autosize:{minRows:2,maxRows:6},class:"message-input",onKeydown:[Me(re(ue,["exact","prevent"]),["enter"]),Me(re(k,["shift"]),["enter"])]},null,8,["modelValue","onKeydown"])]),s("div",ps,[s("button",{type:"button",class:"custom-btn attachment-btn",onClick:Ce},[...i[26]||(i[26]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"})],-1)])]),s("button",{type:"button",class:"custom-btn send-btn",disabled:!O.value,onClick:ue},[...i[27]||(i[27]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"})],-1)])],8,ms)])]),d(ca,{modelValue:L.value,"onUpdate:modelValue":i[5]||(i[5]=f=>L.value=f),"data-sources":X.value,"is-loading":E.value,error:F.value,onConfirm:we,onPreview:Se,onRetry:be},null,8,["modelValue","data-sources","is-loading","error"]),d(Ta,{modelValue:K.value,"onUpdate:modelValue":i[6]||(i[6]=f=>K.value=f),"preview-data":M.value,"is-multi-table":C.value},null,8,["modelValue","preview-data","is-multi-table"])])}}},_s=ie(gs,[["__scopeId","data-v-23485121"]]);export{_s as default};
